<%- include('header', { user: user, guild: guild, activePage: 'servers' }) %>

<div class="main-content">
    <h1>Servidores</h1>
    <p>Aqui estão todos os servidores que você gerencia (Dono ou Administrador). Apenas servidores onde o **Universal Bot** está presente podem ser configurados.</p>

    <% if (showInviteAlert) { %>
        <div class="alert alert-danger">
            ⚠️ **Sem Permissão para Convidar.** Este bot é privado e não pode ser convidado por esta interface.
        </div>
    <% } %>

    <div class="guild-list">
        <% guilds.forEach(g => { 
            // PONTO 2: Truncamento do Nome
            const shortName = g.name.length > 13 ? g.name.substring(0, 10) + '...' : g.name; 
        %>
            <div class="guild-item <%= g.canConfigure ? 'ready' : 'denied' %>">
                <img src="<%= g.icon ? `https://cdn.discordapp.com/icons/${g.id}/${g.icon}.png` : 'https://i.imgur.com/6SqtAxSamTPqFNcxZ.png' %>" 
                     alt="Ícone" class="guild-icon">
                
                <div class="guild-details">
                    <span class="guild-name" title="<%= g.name %>"><%= shortName %></span>
                    <span class="guild-role-tag"><%= g.userRole %></span> 
                </div>

                <% if (g.canConfigure) { %>
                    <a href="/dashboard/<%= g.id %>" class="btn btn-primary status-btn">Configurar</a>
                <% } else { %>
                    <a href="/invite/denied" class="btn btn-denied status-btn">Bot Ausente</a>
                <% } %>
            </div>
        <% }); %>
    </div>
</div>

<%- include('footer') %>